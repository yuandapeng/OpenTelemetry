# ğŸ”§ Grafana é…ç½® Jaeger æ•°æ®æº - æ•…éšœæ’æŸ¥

## âŒ é”™è¯¯ï¼š"Please enter a valid URL"

å¦‚æœçœ‹åˆ°è¿™ä¸ªé”™è¯¯ï¼Œå°è¯•ä»¥ä¸‹è§£å†³æ–¹æ¡ˆï¼š

## âœ… è§£å†³æ–¹æ¡ˆ

### æ–¹æ¡ˆ 1ï¼šæ£€æŸ¥ URL æ ¼å¼ï¼ˆæœ€å¸¸è§ï¼‰

åœ¨ Grafana ä¸­é…ç½® Jaeger æ•°æ®æºæ—¶ï¼š

1. **URL å­—æ®µ**ï¼šè¾“å…¥ `http://jaeger:16686`
   - âœ… æ­£ç¡®ï¼š`http://jaeger:16686`
   - âŒ é”™è¯¯ï¼š`http://jaeger:16686/`ï¼ˆå°¾éƒ¨æ–œæ ï¼‰
   - âŒ é”™è¯¯ï¼š`http://localhost:16686`ï¼ˆä¸èƒ½ä½¿ç”¨ localhostï¼‰
   - âŒ é”™è¯¯ï¼š`jaeger:16686`ï¼ˆç¼ºå°‘åè®®ï¼‰

2. **ç¡®ä¿æ²¡æœ‰å¤šä½™ç©ºæ ¼**ï¼šå¤åˆ¶ç²˜è´´æ—¶æ³¨æ„

3. **Authentication**: é€‰æ‹© "No Authentication"

### æ–¹æ¡ˆ 2ï¼šä½¿ç”¨å®¹å™¨ IP åœ°å€

å¦‚æœæœåŠ¡åä¸å·¥ä½œï¼Œä½¿ç”¨ IP åœ°å€ï¼š

1. è·å– Jaeger å®¹å™¨ IPï¼š
   ```bash
   docker inspect jaeger --format '{{range .NetworkSettings.Networks}}{{.IPAddress}}{{end}}'
   ```
   è¾“å‡ºç¤ºä¾‹ï¼š`172.18.0.2`

2. åœ¨ Grafana ä¸­ä½¿ç”¨ï¼š
   ```
   URL: http://172.18.0.2:16686
   ```

### æ–¹æ¡ˆ 3ï¼šæ£€æŸ¥ Grafana ç‰ˆæœ¬

æŸäº› Grafana ç‰ˆæœ¬å¯¹ Jaeger æ•°æ®æºçš„æ”¯æŒå¯èƒ½ä¸åŒï¼š

1. æ£€æŸ¥ Grafana ç‰ˆæœ¬ï¼š
   ```bash
   docker exec grafana grafana-server -v
   ```

2. å¦‚æœç‰ˆæœ¬è¾ƒæ—§ï¼Œè€ƒè™‘å‡çº§ï¼š
   ```yaml
   # docker-compose.yml
   grafana:
     image: grafana/grafana:latest  # ä½¿ç”¨æœ€æ–°ç‰ˆæœ¬
   ```

### æ–¹æ¡ˆ 4ï¼šéªŒè¯ç½‘ç»œè¿æ¥

åœ¨é…ç½®å‰ï¼Œå…ˆéªŒè¯ Grafana èƒ½å¦è®¿é—® Jaegerï¼š

```bash
# ä» Grafana å®¹å™¨æµ‹è¯•è¿æ¥
docker exec grafana curl -s http://jaeger:16686/api/services

# åº”è¯¥è¿”å› JSON æ ¼å¼çš„æœåŠ¡åˆ—è¡¨
```

å¦‚æœè¿”å› 200 å’Œ JSON æ•°æ®ï¼Œè¯´æ˜ç½‘ç»œæ­£å¸¸ï¼Œé—®é¢˜åœ¨ Grafana é…ç½®ã€‚

### æ–¹æ¡ˆ 5ï¼šé‡æ–°åˆ›å»ºæ•°æ®æº

å¦‚æœä»¥ä¸Šéƒ½ä¸è¡Œï¼Œå°è¯•åˆ é™¤å¹¶é‡æ–°åˆ›å»ºï¼š

1. åœ¨ Grafana ä¸­åˆ é™¤ç°æœ‰çš„ Jaeger æ•°æ®æº
2. é‡æ–°æ·»åŠ æ•°æ®æº
3. ä½¿ç”¨å®Œå…¨ç›¸åŒçš„é…ç½®ï¼š`http://jaeger:16686`

## ğŸ” éªŒè¯é…ç½®

é…ç½®æˆåŠŸåï¼š

1. ç‚¹å‡» **Save & test**
2. åº”è¯¥çœ‹åˆ°ç»¿è‰²æç¤ºï¼š"Data source is working"

## ğŸ“ å®Œæ•´é…ç½®æ­¥éª¤

1. **è¿›å…¥æ•°æ®æºé…ç½®**ï¼š
   - Grafana â†’ Configuration â†’ Data sources
   - ç‚¹å‡» "Add data source"
   - é€‰æ‹© "Jaeger"

2. **é…ç½®è¿æ¥**ï¼š
   - **Name**: `jaeger`ï¼ˆæˆ–ä»»æ„åç§°ï¼‰
   - **URL**: `http://jaeger:16686`
   - **Default**: å¯é€‰ï¼ˆè®¾ä¸ºé»˜è®¤æ•°æ®æºï¼‰

3. **é…ç½®è®¤è¯**ï¼š
   - **Authentication method**: "No Authentication"

4. **ä¿å­˜**ï¼š
   - æ»šåŠ¨åˆ°åº•éƒ¨
   - ç‚¹å‡» "Save & test"
   - ç­‰å¾…æµ‹è¯•ç»“æœ

## ğŸ¯ ä½¿ç”¨ Jaeger æ•°æ®æº

### âš ï¸ é‡è¦æç¤º

Grafana çš„ Jaeger æ•°æ®æºåœ¨ Explore ä¸­çš„ä½¿ç”¨æ–¹å¼æœ‰é™ï¼š
- **ä¸æ”¯æŒç›´æ¥è¾“å…¥ traceId æŸ¥è¯¢**
- **éœ€è¦é€šè¿‡æœåŠ¡é€‰æ‹©å™¨é€‰æ‹©æœåŠ¡**
- **æ¨èç›´æ¥ä½¿ç”¨ Jaeger UI æŸ¥çœ‹ Traces**

### åœ¨ Explore ä¸­ä½¿ç”¨ï¼ˆå¦‚æœé…ç½®æˆåŠŸï¼‰

1. **è¿›å…¥ Explore**ï¼š
   - ç‚¹å‡»å·¦ä¾§èœå• **Explore**
   - é€‰æ‹© **Jaeger** æ•°æ®æº

2. **é€‰æ‹©æœåŠ¡**ï¼š
   - åœ¨æŸ¥è¯¢æ¡†ä¸­ï¼Œä½¿ç”¨ä¸‹æ‹‰èœå•é€‰æ‹©æœåŠ¡å
   - ä¸è¦ç›´æ¥è¾“å…¥ traceId

3. **æŸ¥çœ‹ Traces**ï¼š
   - é€‰æ‹©æœåŠ¡åï¼Œä¼šæ˜¾ç¤ºè¯¥æœåŠ¡çš„æ‰€æœ‰ Traces
   - ç‚¹å‡» Trace æŸ¥çœ‹è¯¦æƒ…

### æ¨èï¼šç›´æ¥ä½¿ç”¨ Jaeger UI

**æ›´ç®€å•ã€åŠŸèƒ½æ›´å®Œæ•´**ï¼š
- è®¿é—®ï¼šhttp://localhost:16686
- é€‰æ‹©æœåŠ¡ï¼š`service-a` æˆ– `service-b`
- ç‚¹å‡» "Find Traces"
- æ”¯æŒ traceId ç›´æ¥æœç´¢

### åœ¨ Dashboard ä¸­å¯è§†åŒ–

1. åˆ›å»º Dashboard
2. æ·»åŠ  Panel
3. é€‰æ‹© Jaeger æ•°æ®æº
4. é…ç½®æŸ¥è¯¢ï¼ˆé€‰æ‹©æœåŠ¡åï¼‰

## ğŸ“ å…³äº 400 é”™è¯¯

å¦‚æœçœ‹åˆ° 400 Bad Requestï¼š
- **åŸå› **ï¼šå¯èƒ½æ˜¯æŸ¥è¯¢æ ¼å¼ä¸æ­£ç¡®
- **è§£å†³**ï¼šä½¿ç”¨æœåŠ¡é€‰æ‹©å™¨ï¼Œä¸è¦ç›´æ¥è¾“å…¥ traceId
- **æ›¿ä»£**ï¼šç›´æ¥ä½¿ç”¨ Jaeger UI (http://localhost:16686)

## ğŸ’¡ æç¤º

- **URL éªŒè¯**ï¼šGrafana çš„ URL éªŒè¯å¯èƒ½æ¯”è¾ƒä¸¥æ ¼ï¼Œç¡®ä¿æ ¼å¼å®Œå…¨æ­£ç¡®
- **ç½‘ç»œéš”ç¦»**ï¼šç¡®ä¿ Grafana å’Œ Jaeger åœ¨åŒä¸€ä¸ª Docker ç½‘ç»œä¸­
- **ç«¯å£æ£€æŸ¥**ï¼šç¡®è®¤ Jaeger çš„ 16686 ç«¯å£å·²æ˜ å°„å¹¶è¿è¡Œ

## ğŸ› å¦‚æœä»ç„¶æ— æ³•è§£å†³

1. æ£€æŸ¥ Docker ç½‘ç»œï¼š
   ```bash
   docker network inspect study-opentelemetry_otel-network
   ```
   ç¡®è®¤ `grafana` å’Œ `jaeger` éƒ½åœ¨åŒä¸€ä¸ªç½‘ç»œä¸­

2. æŸ¥çœ‹ Grafana æ—¥å¿—ï¼š
   ```bash
   docker logs grafana --tail 50
   ```
   æŸ¥æ‰¾ä¸ Jaeger è¿æ¥ç›¸å…³çš„é”™è¯¯ä¿¡æ¯

3. ä¸´æ—¶ä½¿ç”¨å¤–éƒ¨è®¿é—®ï¼š
   å¦‚æœ Docker ç½‘ç»œæœ‰é—®é¢˜ï¼Œå¯ä»¥ä¸´æ—¶ä½¿ç”¨ï¼š
   ```
   URL: http://host.docker.internal:16686
   ```
   ï¼ˆä»…é™ macOS/Windowsï¼ŒLinux éœ€è¦å…¶ä»–æ–¹æ³•ï¼‰

